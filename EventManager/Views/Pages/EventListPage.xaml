<Page x:Class="EventManager.Views.Pages.EventListPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Grid Background="{StaticResource LightGrayBrush}">
        <!-- Action Bar -->
        <Grid Style="{StaticResource ActionBarStyle}" VerticalAlignment="Top">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <Button x:Name="BackButton" Style="{StaticResource HamburgerButton}"
                       Content="&#xE72B;" Click="BackButton_Click"/>
                <TextBlock Text="Event List &amp; Search" FontSize="18" FontWeight="Bold"
                          Foreground="{StaticResource WhiteBrush}" VerticalAlignment="Center" Margin="10,0"/>
            </StackPanel>
        </Grid>

        <!-- Content -->
        <ScrollViewer Margin="0,60,0,0">
            <StackPanel Style="{StaticResource MobileContainer}">

                <!-- Search Section -->
                <TextBlock Text="Search Events" Style="{StaticResource FieldLabel}"/>

                <!-- Name Search -->
                <TextBlock Text="Name:" Style="{StaticResource FieldLabel}" Margin="5,5,5,0"/>
                <TextBox x:Name="NameSearchBox" Style="{StaticResource SearchBox}" 
                        TextChanged="SearchBox_TextChanged"/>

                <!-- Description Search -->
                <TextBlock Text="Description:" Style="{StaticResource FieldLabel}"/>
                <TextBox x:Name="DescriptionSearchBox" Style="{StaticResource SearchBox}"
                        TextChanged="SearchBox_TextChanged"/>

                <!-- Type Filter -->
                <TextBlock Text="Event Type:" Style="{StaticResource FieldLabel}"/>
                <ComboBox x:Name="EventTypeComboBox" Style="{StaticResource LargeComboBox}"
                         SelectionChanged="FilterChanged"/>

                <!-- Attendance Filter -->
                <TextBlock Text="Attendance:" Style="{StaticResource FieldLabel}"/>
                <ComboBox x:Name="AttendanceComboBox" Style="{StaticResource LargeComboBox}"
                         SelectionChanged="FilterChanged"/>

                <!-- Buttons -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10">
                    <Button Content="🔍 Search" Style="{StaticResource PrimaryButton}" 
                           Click="SearchButton_Click" Margin="5"/>
                    <Button Content="❌ Cancel" Style="{StaticResource DangerButton}" 
                           Click="CancelButton_Click" Margin="5"/>
                </StackPanel>

                <!-- Live Filter -->
                <TextBlock Text="Filter (live):" Style="{StaticResource FieldLabel}" Margin="0,20,0,0"/>
                <TextBox x:Name="LiveFilterBox" Style="{StaticResource SearchBox}"
                        TextChanged="LiveFilter_TextChanged"/>
                <Button Content="❌ Cancel" Style="{StaticResource DangerButton}" 
                       Click="CancelFilterButton_Click" Margin="5" HorizontalAlignment="Center"/>

                <!-- Events List -->
                <ListView x:Name="EventsListView" Margin="0,20,0,0" 
                         Background="{StaticResource WhiteBrush}"
                         BorderBrush="{StaticResource DarkGrayBrush}"
                         BorderThickness="1">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Margin="10" Background="{StaticResource WhiteBrush}">
                                <StackPanel Orientation="Horizontal">
                                    <Button Content="❌" Background="Transparent" BorderThickness="0" 
                                           FontSize="16" Margin="0,0,10,0" Click="DeleteEvent_Click"/>
                                    <TextBlock Text="{Binding Name}" FontWeight="Bold" FontSize="16" VerticalAlignment="Center"/>
                                    <Button Content="✏️" Background="Transparent" BorderThickness="0" 
                                           FontSize="16" Margin="10,0,0,0" Click="EditEvent_Click"/>
                                    <Button Content="ℹ️" Background="Transparent" BorderThickness="0" 
                                           FontSize="16" Margin="5,0,0,0" Click="InfoEvent_Click"/>
                                </StackPanel>
                                <TextBlock Text="{Binding Description}" FontSize="12" Margin="0,5"/>
                                <StackPanel Orientation="Horizontal" Margin="0,5">
                                    <TextBlock Text="📍" FontSize="12" Margin="0,0,5,0"/>
                                    <TextBlock Text="{Binding City}" FontSize="12"/>
                                    <TextBlock Text=", " FontSize="12"/>
                                    <TextBlock Text="{Binding Country}" FontSize="12"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,2">
                                    <TextBlock Text="📅" FontSize="12" Margin="0,0,5,0"/>
                                    <TextBlock Text="{Binding CurrentYearDate, StringFormat='yyyy-MM-dd'}" FontSize="12"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,2">
                                    <TextBlock Text="💲" FontSize="12" Margin="0,0,5,0"/>
                                    <TextBlock Text="{Binding AveragePrice, StringFormat='${0}'}" FontSize="12"/>
                                </StackPanel>
                            </StackPanel>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>