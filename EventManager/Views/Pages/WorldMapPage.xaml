<!-- EventManager/Views/Pages/WorldMapPage.xaml - DYNAMIC VERSION -->
<Page x:Class="EventManager.Views.Pages.WorldMapPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Grid Background="{StaticResource LightGrayBrush}">
        <!-- Action Bar -->
        <Grid Style="{StaticResource ActionBarStyle}" VerticalAlignment="Top">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <Button x:Name="BackButton" Style="{StaticResource HamburgerButton}"
                       Content="&#xE700;" Click="BackButton_Click"/>
                <TextBlock Text="World Map" FontSize="18" FontWeight="Bold"
                          Foreground="{StaticResource WhiteBrush}" VerticalAlignment="Center" Margin="10,0"/>
            </StackPanel>
        </Grid>

        <!-- Content - DYNAMIC VERSION -->
        <ScrollViewer Margin="0,60,0,0" 
                     VerticalScrollBarVisibility="Auto"
                     HorizontalScrollBarVisibility="Disabled">

            <StackPanel Margin="20">

                <!-- Filter by Name -->
                <TextBlock Text="Filter by Name:" FontSize="16" FontWeight="SemiBold" Margin="0,10,0,5"/>
                <TextBox x:Name="MapFilterTextBox" 
                         Height="40" 
                         Margin="0,0,0,15"
                         FontSize="14"
                         Padding="8"
                         BorderThickness="2"
                         BorderBrush="{StaticResource DarkGrayBrush}"
                         TextChanged="MapFilterTextBox_TextChanged"
                         GotFocus="MapFilterTextBox_GotFocus"
                         LostFocus="MapFilterTextBox_LostFocus"/>

                <!-- Available Events - DYNAMIC VERSION -->
                <TextBlock Text="Available Events:" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10"/>

                <!-- DYNAMIC: ItemsControl instead of hardcoded buttons -->
                <ItemsControl x:Name="AvailableEventsPanel" Margin="0,0,0,15">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <UniformGrid Columns="2" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>

                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Button Style="{StaticResource IconTextButton}" 
                                   Height="40" 
                                   Margin="2"
                                   PreviewMouseLeftButtonDown="EventButton_MouseLeftButtonDown"
                                   PreviewMouseMove="EventButton_MouseMove"
                                   PreviewMouseLeftButtonUp="EventButton_MouseLeftButtonUp"
                                   Tag="{Binding}">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="{Binding EventTypeIcon}" FontSize="16" Margin="5,0,8,0" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding Name}" FontSize="14" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                </StackPanel>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

                <!-- Map Area - SAME AS BEFORE -->
                <Border Background="{StaticResource WhiteBrush}" 
                       BorderBrush="{StaticResource DarkGrayBrush}" 
                       BorderThickness="2" 
                       CornerRadius="0"
                       Margin="0,10" 
                       Height="300">

                    <Canvas x:Name="MapCanvas" 
                           Background="#87CEEB" 
                           ClipToBounds="True"
                           Drop="MapCanvas_Drop"
                           AllowDrop="True"
                           DragOver="MapCanvas_DragOver">

                        <!-- World Map Continents - SAME AS BEFORE -->

                        <!-- North America -->
                        <Polygon Fill="#90EE90" 
                                Stroke="#228B22" 
                                StrokeThickness="1"
                                Points="20,60 80,50 110,80 120,120 90,140 60,150 30,130 10,100"/>

                        <!-- South America -->
                        <Polygon Fill="#98FB98" 
                                Stroke="#228B22" 
                                StrokeThickness="1"
                                Points="70,160 90,150 100,180 95,220 85,250 75,260 65,250 60,220 65,190"/>

                        <!-- Europe -->
                        <Polygon Fill="#9AFF9A" 
                                Stroke="#228B22" 
                                StrokeThickness="1"
                                Points="150,40 180,45 190,70 185,90 175,95 160,90 150,75 145,60"/>

                        <!-- Africa -->
                        <Polygon Fill="#F4A460" 
                                Stroke="#D2691E" 
                                StrokeThickness="1"
                                Points="160,100 185,95 200,120 195,160 185,200 175,220 165,210 155,180 150,140 155,120"/>

                        <!-- Asia -->
                        <Polygon Fill="#DDA0DD" 
                                Stroke="#9370DB" 
                                StrokeThickness="1"
                                Points="200,30 280,35 320,60 340,90 330,120 310,140 280,135 250,125 220,110 200,80"/>

                        <!-- Australia -->
                        <Ellipse Fill="#FFB6C1" 
                                Stroke="#FF69B4" 
                                StrokeThickness="1"
                                Width="60" Height="35" 
                                Canvas.Left="290" Canvas.Top="220"/>

                        <!-- Antarctica (bottom) -->
                        <Rectangle Fill="#F0F8FF" 
                                  Stroke="#B0C4DE" 
                                  StrokeThickness="1"
                                  Width="350" Height="25" 
                                  Canvas.Left="20" Canvas.Top="270"/>

                        <!-- Islands and details -->
                        <Ellipse Fill="#90EE90" Width="8" Height="6" Canvas.Left="100" Canvas.Top="45"/>
                        <Ellipse Fill="#90EE90" Width="6" Height="4" Canvas.Left="140" Canvas.Top="50"/>
                        <Ellipse Fill="#DDA0DD" Width="12" Height="8" Canvas.Left="340" Canvas.Top="120"/>
                        <Ellipse Fill="#F4A460" Width="10" Height="8" Canvas.Left="210" Canvas.Top="140"/>

                        <!-- Country Labels -->
                        <TextBlock Text="USA" FontSize="8" Canvas.Left="50" Canvas.Top="90" Foreground="DarkGreen" FontWeight="Bold"/>
                        <TextBlock Text="Brazil" FontSize="8" Canvas.Left="75" Canvas.Top="200" Foreground="DarkGreen" FontWeight="Bold"/>
                        <TextBlock Text="Europe" FontSize="8" Canvas.Left="155" Canvas.Top="65" Foreground="DarkGreen" FontWeight="Bold"/>
                        <TextBlock Text="Africa" FontSize="8" Canvas.Left="170" Canvas.Top="150" Foreground="SaddleBrown" FontWeight="Bold"/>
                        <TextBlock Text="Asia" FontSize="8" Canvas.Left="260" Canvas.Top="80" Foreground="DarkMagenta" FontWeight="Bold"/>
                        <TextBlock Text="Australia" FontSize="8" Canvas.Left="305" Canvas.Top="235" Foreground="DeepPink" FontWeight="Bold"/>

                        <!-- Drop Indicator (hidden by default) -->
                        <Border x:Name="DropIndicator" 
                               Background="LightBlue" 
                               BorderBrush="Blue" 
                               BorderThickness="2" 
                               Width="30" 
                               Height="30" 
                               Visibility="Collapsed"
                               Opacity="0.7"
                               CornerRadius="15">
                            <TextBlock Text="📍" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>

                    </Canvas>
                </Border>

                <!-- Search Map -->
                <TextBlock Text="Search Map:" FontSize="16" FontWeight="SemiBold" Margin="0,15,0,5"/>
                <TextBox x:Name="SearchMapTextBox"
                         Height="40" 
                         Margin="0,0,0,20"
                         FontSize="14"
                         Padding="8"
                         BorderThickness="2"
                         BorderBrush="{StaticResource DarkGrayBrush}"
                         Foreground="{StaticResource DarkGrayBrush}"
                         FontStyle="Italic"/>

                <!-- Events on Map List -->
                <Border x:Name="EventsOnMapSection" 
                       Background="{StaticResource WhiteBrush}" 
                       BorderBrush="{StaticResource DarkGrayBrush}" 
                       BorderThickness="1" 
                       CornerRadius="5" 
                       Padding="10" 
                       Margin="0,10"
                       Visibility="Collapsed">

                    <StackPanel>
                        <TextBlock Text="Events on Map:" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>

                        <ListView x:Name="EventsOnMapListView" 
                                 Background="Transparent"
                                 BorderThickness="0"
                                 MaxHeight="100">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="📍" FontSize="14" Margin="0,0,5,0"/>
                                        <TextBlock Text="{Binding Name}" FontSize="14" Width="120"/>
                                        <Button Content="❌" 
                                               FontSize="12" 
                                               Background="Transparent" 
                                               BorderThickness="0" 
                                               Width="25" 
                                               Height="25"
                                               Click="RemoveFromMap_Click"/>
                                    </StackPanel>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>

                        <TextBlock x:Name="NoEventsOnMapText" 
                                  Text="No events on map." 
                                  FontStyle="Italic" 
                                  Foreground="{StaticResource DarkGrayBrush}"
                                  HorizontalAlignment="Center"
                                  Margin="0,5"/>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>